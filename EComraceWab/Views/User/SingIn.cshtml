@model EComraceWab.Entites.User

@{
    Layout = "~/Views/Shared/_Layout1.cshtml";
}

<style>
    .container {
        max-width: 1260px;
        margin: 20px auto;
        padding: 1px;
    }

    h1 {
        font-size: 20px;
        text-align: center;
        margin: 20px 0 20px;
    }

        h1 small {
            display: block;
            font-size: 15px;
            padding-top: 8px;
            color: gray;
        }

    .avatar-upload {
        position: relative;
        max-width: 205px;
        margin: 50px auto;
    }

        .avatar-upload .avatar-edit {
            position: absolute;
            right: 12px;
            z-index: 1;
            top: 10px;
        }

            .avatar-upload .avatar-edit input {
                display: none;
            }

                .avatar-upload .avatar-edit input + label {
                    display: inline-block;
                    width: 34px;
                    height: 34px;
                    margin-bottom: 0;
                    border-radius: 100%;
                    background: #FFFFFF;
                    border: 1px solid transparent;
                    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.12);
                    cursor: pointer;
                    font-weight: normal;
                    transition: all 0.2s ease-in-out;
                }

                    .avatar-upload .avatar-edit input + label:hover {
                        background: #f1f1f1;
                        border-color: #d6d6d6;
                    }

                    .avatar-upload .avatar-edit input + label:after {
                        content: "";
                        font-family: 'FontAwesome';
                        color: #757575;
                        position: absolute;
                        top: 10px;
                        left: 0;
                        right: 0;
                        text-align: center;
                        margin: auto;
                    }

        .avatar-upload .avatar-preview {
            width: 192px;
            height: 192px;
            position: relative;
            border-radius: 100%;
            border: 6px solid #F8F8F8;
            box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.1);
        }

            .avatar-upload .avatar-preview > div {
                width: 100%;
                height: 100%;
                border-radius: 100%;
                background-size: cover;
                background-repeat: no-repeat;
                background-position: center;
            }
           

</style>

<section class="padding-y bg-light">
    <div class="container">


        <div class="row">
            <main class="col-xl-8 col-lg-8" id="model">

                <article class="card mb-4" id="Rolediv">
                    <div class="content-body">
                        <h5 class="card-title"> Select Your Role </h5>

                        <div class="row mb-3" id="Roles">
                        </div>
                    </div>
                </article>

                <!-- ============== COMPONENT CHECKOUT =============== -->
                <article class="card">
                   @* <div class="content-body">
                        <div>
                        <img  class="css-border" src="~/images/default.png.png" id="img">
                            <i class="bi bi-camera"> </i>
                            <input type="file"  id="Image" name="image" onchange="UplodImagee(this)"  />
                     </div>*@
                        <div class="container">
                            <div class="avatar-upload">
                                <div class="avatar-edit">
                                    <input type='file' id="imageUpload" accept=".png, .jpg, .jpeg" />
                                    <label for="imageUpload" class="bi bi-camera-fill"></label>
                                </div>
                                <div class="avatar-preview">
                                <div id="imagePreview" style="background-image: url('https://static.thenounproject.com/png/5034901-200.png');">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <h5 class="card-title">  </h5>
                        <div class="row">
                            <div class="col-6 mb-3">
                                <label class="form-label">FirstName</label>
                                <input type="text" class="form-control" placeholder="Type here FirstName" id="FirstName">
                            </div> <!-- col end.// -->

                            <div class="col-6">
                                <label class="form-label">LastName</label>
                                <input type="text" class="form-control" placeholder="Type here LastName" id="LastName">
                            </div>
                            <div class="col-6 mb-3">
                                <label class="form-label">Email address</label>
                                <input type="email" class="form-control" placeholder="Type here Email" id="Email">
                            </div> <!-- col end.// -->

                            <div class="col-6">
                                <label class="form-label">password</label>
                                <input type="password" class="form-control" placeholder="Type here Password" id="Password">
                            </div> <!-- col end.// -->

                            <div class="col-6 mb-3">
                                <label class="form-label">Confirm Password</label>
                                <input type="password" class="form-control" placeholder="Type here ConfirmPassword" id="ConfirmPassword">
                            </div> <!-- col end.// -->
                            <!-- col end.// -->
                        </div> <!-- row.// -->


                        <hr class="my-4">

                        <!-- row end.// -->

                        <div class="row" id="Store">
                            <div class="col-6 mb-3">
                                <label class="form-label">Store name</label>
                                <input type="text" class="form-control" placeholder="Type here Store name" id="Name">
                            </div> <!-- col end.// -->

                            <div class="col-6">
                                <label class="form-label">Phone</label>
                                <input type="text" class="form-control" placeholder="Type here Phone " id="Phone">
                            </div>
                            <div class="col-sm-8 mb-3" id="Addressdiv">
                                <label for="" class="form-label">Address</label>
                                <input type="text" class="form-control" placeholder="Type here Address" id="Address">
                            </div>
                            <div class="col-sm-4 mb-3" id="Citydiv">
                                <label for="" class="form-label">City*</label>
                                <input type="text" class="form-control" placeholder="Type here City" id="City">
                            </div>

                            <div class="mb-4">
                                <label for="" class="form-label">Shipping Info</label>
                                <textarea class="form-control" id="ShippingInfo"></textarea>
                            </div> <!-- col end.// -->

                        </div>
                        <div class="float-end">
                            <button id="btnCreate" class="btn btn-success">Create</button>
                        </div>
                    </div> <!-- card-body end.// -->
                </article> <!-- card end.// -->
                <!-- ============== COMPONENT CHECKOUT .// =============== -->

            </main> <!-- col.// -->
            <!-- ============== COMPONENT SUMMARY .// =============== -->
            <aside class="col-xl-4 col-lg-4">
                <!-- ============== COMPONENT SUMMARY =============== -->
                <article class="ms-lg-4 mt-4 mt-lg-0" style="max-width: 320px" id="Items">
                   




                </article>
                <!-- ============== COMPONENT SUMMARY .// =============== -->
            </aside> <!-- col.// -->
        </div> <!-- row.// -->

        <br><br>

    </div> <!-- container .//  -->
</section>

<script type="text/javascript">
    $(document).ready(function () {
        debugger


        Role();
        $("#Store").hide();
        let url_str = window.location.href;
        let url = new URL(url_str);
        let search_params = url.searchParams;

        let id = search_params.get('Id');
        if (id != null) {
            $("#Rolediv").hide();

        }

    });
    function UplodImagee(input) {
     //   $("#image").hide();
        debugger
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (element) {
                $("#img").attr("src", element.target.result).width(100).height(100);
                console.log(element);

            };
            reader.readAsDataURL(input.files[0]);
           // $("#Image").show();
        };
    };
    function Role() {
        debugger


        $.ajax({
            url: '/Home/Role',
            success: function (response) {
                debugger
                var item = '';

                debugger
                console.log(response);
                $.each(response, function (key, obj) {
                    item += '<div class="col-lg-4 mb-3" >';
                    item += '<div class="box box-check" >';
                    item += '<label class="form-check" >';
                    item += "<input class='form-check-input' type ='radio' onclick='Getid(" + obj.Id + ");' value=" + obj.Id + " name = 'dostavka' checked >";
                    item += '<b class="border-oncheck" ></b>';
                    item += "<span class='form-check-label'>" + obj.Role + "</span>";
                    item += '</label>';
                    item += '</div>'
                    item += '</div>';
                });
                $("#Roles").append(item);
            }
        });
    }
    function Getid(Id) {
        debugger
        if (Id == 2) {
            $("#Store").show();
        }
        else {
            $("#Store").hide();
        }
    };
    //const togglePassword = document.querySelector("#togglePassword");
    //const password = document.querySelector("#Password");

    //togglePassword.addEventListener("click", function () {

    //    // toggle the type attribute
    //    const type = password.getAttribute("type") === "password" ? "text" : "password";
    //    password.setAttribute("type", type);

    //    // toggle the eye icon
    //    this.classList.toggle('bi-eye');
    //});
    //const ConfirmPassword = document.querySelector("#confirmPassword");
    //const confirmPassword = document.querySelector("#ConfirmPassword");

    //ConfirmPassword.addEventListener("click", function () {

    //    // toggle the type attribute
    //    const type = confirmPassword.getAttribute("type") === "password" ? "text" : "password";
    //    confirmPassword.setAttribute("type", type);

    //    // toggle the eye icon
    //    this.classList.toggle('bi-eye');
    //});
    $("#btnCreate").click(function () {
        debugger
        let url_str = window.location.href;
        let url = new URL(url_str);
        let search_params = url.searchParams;

        let id = search_params.get('Id');
        if (id != null) {
            var first_name = $('#FirstName').val();
            var last_name = $('#LastName').val();
            var email = $('#Email').val();
            var password = $('#Password').val();
            var confirmPassword = $('#ConfirmPassword').val();

            $(".error").remove();

            if (first_name.length < 1) {
                $('#FirstName').after('<span class="error text-danger">This FirstName is required</span>');
                return;
            }
            if (last_name.length < 1) {
                $('#LastName').after('<span class="error text-danger ">This LastName is required</span>');
                return;
            }
            if (email.length < 1) {
                $('#Email').after('<span class="error text-danger">This Email is required</span>');
                return;
            }

            if (password.length < 8) {
                $('#Password').after('<span class="error text-danger">Password must be at least 8 characters long</span>');
                return;
            } if (password != confirmPassword) {
                $('#ConfirmPassword').after('<span class="error text-danger">password did not match</span>');
                return;
            }
            var file = $("#imageUpload").get(0).files;
            var data = new FormData;
            data.append("RoleId", id);
            data.append("FirstName", $("#FirstName").val());
            data.append("LastName", $("#LastName").val());
            data.append("Email", $("#Email").val());
            data.append("Password", $("#Password").val());
            data.append("ConfirmPassword", $("#ConfirmPassword").val());
            data.append("Image", file[0])
            debugger
            console.log(data);
        }
        else {

            var first_name = $('#FirstName').val();
            var last_name = $('#LastName').val();
            var email = $('#Email').val();
            var password = $('#Password').val();
            var confirmPassword = $('#ConfirmPassword').val();

            $(".error").remove();

            if (first_name.length < 1) {
                $('#FirstName').after('<span class="error text-danger">This FirstName is required</span>');
                return;
            }
            if (last_name.length < 1) {
                $('#LastName').after('<span class="error text-danger ">This LastName is required</span>');
                return;
            }
            if (email.length < 1) {
                $('#Email').after('<span class="error text-danger">This Email is required</span>');
                return;
            }

            if (password.length < 8) {
                $('#Password').after('<span class="error text-danger">Password must be at least 8 characters long</span>');
                return;
            } if (password != confirmPassword) {
                $('#ConfirmPassword').after('<span class="error text-danger">password did not match</span>');
                return;
            }
            var file = $("#imageUpload").get(0).files;
            var data = new FormData;
            data.append("FirstName", $("#FirstName").val());
            data.append("LastName", $("#LastName").val());
            data.append("Email", $("#Email").val());
            data.append("Password", $("#Password").val());
            data.append("ConfirmPassword", $("#ConfirmPassword").val());
            data.append("Name", $("#Name").val());
            data.append("Address", $("#Address").val());
            data.append("City", $("#City").val());
            data.append("Number", $("#Phone").val());
            data.append("ShippingInfo", $("#ShippingInfo").val());
            data.append("RoleId", $("input[name=dostavka]:checked").val());
            data.append("Image", file[0])
            debugger
            console.log(data);

        }
        $.ajax({
            type: 'POST',
              async: true,
            data:data,
            url: "/User/Register",
            processData: false,
            contentType: false,
            success: function (data) {
                window.location.href = '/Daraz/Home';

            },

            error: function () {
                alert("Something went wrong");
                ("Email is already taken ");
            },
        });
    });
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#imagePreview').css('background-image', 'url(' + e.target.result + ')');
                $('#imagePreview').hide();
                $('#imagePreview').fadeIn(650);
            }
            reader.readAsDataURL(input.files[0]);
        }
    }
    $("#imageUpload").change(function () {
        readURL(this);
    });
</script>
